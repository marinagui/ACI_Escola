package banco_de_dados.dao;

import java.sql.ResultSet;

import banco_de_dados.BD;
import banco_de_dados.dbo.Responsavel;

public class Responsaveis {
	private BD bancoConec;
	
	public Responsaveis()throws Exception{
		this.bancoConec = new BD("com.microsoft.sqlserver.jdbc.SQLServerDriver",
    			"jdbc:sqlserver://regulus:1433;databasename=BD13185",
    			"BD13185", "GeorgeOrwell");
	}
	
	public void inserirResponsavel(Responsavel responsavel) throws Exception{
		ResultSet result = this.bancoConec.execConsulta("Select * from ASI_Responsavel where Email='"
	+responsavel.getEmail()+"'");
		if(result.first()){
			throw new Exception("Responsavel com esse email já existente");
		}
		
		String comSQL = "insert into ASI_Responsavel values('"+
				responsavel.getEmail()+"','"+responsavel.getNome()+
				"','"+ responsavel.getTelefone()+"','"+responsavel.getEndereco() + "')";
		
		this.bancoConec.execComando(comSQL);
	}
	
}
